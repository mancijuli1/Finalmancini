<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/custom.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300&display=swap"
      rel="stylesheet"
    />
    <title>Clientes</title>
  </head>
  <body>
    <div class="container p-4">
      <h2>Clientes</h2>
      <button class="btn btn-verde" data-toggle="modal" data-target="#myModalAdd">Añadir</button>
      <table class="table table-stripped" id="mytable">
        <thead>
            <th>ID</th>
            <th>Nombre y Apellido</th>
            <th>Empresa</th>
            <th>email</th>
            <th>servicio</th>
            <th>precio</th>
            <th>accion</th>
        </thead>
        <tbody>
          {{#each results}}

            <tr>
              <td>{{cliente_id}}</td>
              <td>{{cliente_nombre}}</td>
              <td>{{cliente_empresa}}</td>
              <td>{{cliente_email}}</td>
              <td>{{cliente_servicio}}</td>
              <td>{{precio}}</td>
              <td><a href="javascript:void(0);" class="btn btn-info edit" data-cliente_id="{{cliente_id}}"
               data-cliente_nombre="{{cliente_nombre}}" data-cliente_empresa="{{cliente_empresa}}"
               data-cliente_email="{{cliente_email}}" data-cliente_servicio="{{cliente_servicio}}"
               data-precio="{{precio}}">Editar</a>
                <a href="javascript:void(0);" class="btn btn-danger delete" data-id="{{cliente_id}}">Borrar</a>
              </td>
            </tr>
          {{/each}}
        </tbody>
      </table>
    </div>

    {{! modal para agregar clientes }}

    <form action="/save" method="post">

      <!-- Modal -->
      <div class="modal fade" id="myModalAdd" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Añadir cliente</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>

            <div class="modal-body">
              <div class="form-group">
                <input type="text" name="cliente_nombre" class="form-control" placeholder="Ingresar nombre y apellido"/>
              </div>
              <div class="form-group">
                <input type="text" name="cliente_empresa" class="form-control" placeholder="Ingresar empresa "/>
              </div>
              <div class="form-group">
                <input type="email" name="cliente_email" class="form-control" placeholder="Ingresar email" />
              </div>
              <div class="form-group">
                <input type="text" name="cliente_servicio" class="form-control" placeholder="Ingresar servicio contratado" />
              </div>
              <div class="form-group">
                <input type="int" name="precio" class="form-control" placeholder="precio servicio" />
              </div>
            </div>

            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
              <button type="submit" class="btn btn-primary">Guardar</button>
          
            </div>
          </div>
        </div>
      </div>
    </form>


    {{! modal para editar clientes }}

    <form action="/update" method="post">
     <div class="modal fade" id="EditModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
       <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Editar cliente</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <input type="text" name="cliente_nombre" class="form-control" placeholder="Ingresar nombre y apellido"/>
              </div>
              <div class="form-group">
                <input type="text" name="cliente_empresa" class="form-control" placeholder="Ingresar empresa "/>
              </div>
              <div class="form-group">
                <input type="email" name="cliente_email" class="form-control" placeholder="Ingresar email" />
              </div>
              <div class="form-group">
                <input type="text" name="cliente_servicio" class="form-control" placeholder="Ingresar servicio contratado" />
              </div>
              <div class="form-group">
                <input type="int" name="precio" class="form-control" placeholder="precio servicio" />
              </div>
            </div>
            <div class="modal-footer">
                <input type="hidden" name="cliente_id" class="cliente_id " >
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
              <button type="submit" class="btn btn-primary">Actualizar</button>
            </div>
          </div>
        </div>
      </div>
    </form>

{{!-- Modal para eliminar clientes --}}
  <form id="add-row-form" action="/delete" method="post">
      <div class="modal fade" id="DeleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Borrar cliente</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>

            <div class="modal-body">
                <p>Desea eliminar este cliente?</p>
             </div>
            <div class="modal-footer">
                <input type="hidden" name="cliente_id" class="cliente_id form-control" >
              <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
              <button type="delete" class="btn btn-success">Eliminar</button>
            </div>
          </div>
        </div>
      </div>
    </form>


    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
      integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
      crossorigin="anonymous"
    ></script>
    <script src="assets/js/bootstrap.min.js"></script>

<script>
    $(document).ready(function(){
    $('#mytable').on('click', '.edit', function(){
    let cliente_id = $(this).data('cliente_id');
    let cliente_nombre = $(this).data('cliente_nombre');
    let cliente_empresa = $(this).data('cliente_empresa');
    let cliente_email = $(this).data('cliente_email');
    let cliente_servicio = $(this).data('cliente_servicio');
    let precio = $(this).data('precio');
    $('#EditModal').modal('show');
    $('.cliente_id').val(cliente_id);
    $('.cliente_nombre').val(cliente_nombre);
    $('.cliente_empresa').val(cliente_empresa);
    $('.cliente_email').val(cliente_email);
    $('.cliente_servicio').val(cliente_servicio);
    $('.precio').val(precio);
     })

    $('#mytable').on('click', '.delete', function(){
    let cliente_id = $(this).data('cliente_id');
    $('#DeleteModal').modal('show');
$('.cliente_id').val(cliente_id);
     })  
    })
</script>
  </body>
</html>